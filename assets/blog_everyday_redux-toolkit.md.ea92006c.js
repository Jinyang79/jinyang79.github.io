import{_ as s,o as a,c as n,a as l}from"./app.5b5c79b2.js";const C=JSON.parse('{"title":"Redux Toolkit ä½¿ç”¨æŠ€å·§","description":"","frontmatter":{},"headers":[],"relativePath":"blog/everyday/redux-toolkit.md","lastUpdated":1679813736000}'),p={name:"blog/everyday/redux-toolkit.md"},o=l(`<h1 id="redux-toolkit-ä½¿ç”¨æŠ€å·§" tabindex="-1">Redux Toolkit ä½¿ç”¨æŠ€å·§ <a class="header-anchor" href="#redux-toolkit-ä½¿ç”¨æŠ€å·§" aria-hidden="true">#</a></h1><h2 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€" aria-hidden="true">#</a></h2><p>Hiï¼Œä»Šå¤©å’Œå¤§å®¶åˆ†äº«ä¸€äº›å…³äºä½¿ç”¨ Redux Toolkit çš„å°æŠ€å·§ã€‚</p><p><a href="https://redux-toolkit.js.org/" target="_blank" rel="noreferrer">Redux Toolkit</a> æ˜¯ä¸€ä¸ªå®˜æ–¹æ¨èçš„ Redux å·¥å…·é›†ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¿«æ·ã€æ›´æ–¹ä¾¿åœ°è¿›è¡Œ Redux å¼€å‘ã€‚</p><p>å¾ˆå¤šåŒå­¦åœ¨ä½¿ç”¨ RTK ä¸ Typescript çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ä»£ç é‡å¤ç¼–å†™ã€ç±»å‹ä¸å¿…è¦çš„æ˜¾ç¤ºå£°æ˜ç­‰ç­‰ã€‚</p><p>æœ¬æ–‡å°†ä¼šåˆ†äº«å‡ ä¸ªæ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨ RTK çš„å°æŠ€å·§ï¼Œå¸®åŠ©å¤§å®¶å‡å°‘ä»£ç é‡ï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´ï¼Œæé«˜ä»£ç è´¨é‡ã€‚</p><p>å¸Œæœ›å¯¹ä½ ä½¿ç”¨ RTK æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœæœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œä¹Ÿæ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºåˆ†äº«è‡ªå·±å¯¹ RTK çš„ä½¿ç”¨ç»éªŒã€‚</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>é¡¹ç›®éµå¾ª <a href="https://redux.js.org/style-guide/" target="_blank" rel="noreferrer">Redux Style Guide</a> å¼€å‘</p><p>ç›¸å…³ dependencies:</p><p><code>&quot;@reduxjs/toolkit&quot;: &quot;^1.9.3&quot;,</code></p><p><code>&quot;react&quot;: &quot;^18.2.0&quot;,</code></p><p><code>&quot;typescript&quot;: &quot;^4.6.0&quot;,</code></p></div><h2 id="æå–-slicename" tabindex="-1">æå– sliceName <a class="header-anchor" href="#æå–-slicename" aria-hidden="true">#</a></h2><p>åˆ›å»ºåˆ‡ç‰‡çš„æ—¶å€™ï¼Œä½¿ç”¨å˜é‡æŒ‡å®š slice nameï¼Œç”Ÿæˆ action ç±»å‹å°†ä¼šä½¿ç”¨å®ƒä½œä¸ºå‰ç¼€ã€‚</p><p>è¿™æ ·ï¼Œå½“æˆ‘ä»¬åœ¨åº”ç”¨ä¸­ä½¿ç”¨ dispatch è§¦å‘ action æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡ action ç±»å‹ä¸­çš„ slice åç§°æ¥åŒºåˆ†ä¸åŒçš„ reducer å‡½æ•°ã€‚å¹¶ä¸”ä½¿ä»£ç æ›´åŠ æ¸…æ™°æ˜“æ‡‚ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚</p><h3 id="before" tabindex="-1">before <a class="header-anchor" href="#before" aria-hidden="true">#</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-JibJS" id="tab-j36OCRN" checked="checked"><label for="tab-j36OCRN">features/todos/todosSlice.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-highlighted-lines"><code><span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">getTodoData</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAsyncThunk</span><span style="color:#ADBAC7;">(</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">\`todos/getTodoList\`</span><span style="color:#ADBAC7;">,  </span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">async</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">params</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#768390;">//...</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">postTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">\`todos/postTodoItem\`</span><span style="color:#ADBAC7;">, </span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#6CB6FF;">async</span><span style="color:#ADBAC7;"> (params) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#768390;">//...</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">// more createAsyncThunk ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">todosSlice</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createSlice</span><span style="color:#ADBAC7;">({</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">  name: </span><span style="color:#96D0FF;">&#39;todos&#39;</span><span style="color:#ADBAC7;">, </span></span>
<span class="line"><span style="color:#ADBAC7;">  initialState,</span></span>
<span class="line"><span style="color:#ADBAC7;">  reducers: { </span><span style="color:#768390;">//... },</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#DCBDFB;">extraReducers</span><span style="color:#ADBAC7;">: (</span><span style="color:#F69D50;">builder</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span><span style="color:#768390;">//... },</span></span>
<span class="line"><span style="color:#ADBAC7;">});</span></span>
<span class="line"></span></code></pre></div></div></div><h3 id="after" tabindex="-1">after <a class="header-anchor" href="#after" aria-hidden="true">#</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-L7j-u" id="tab-y0xDLaV" checked="checked"><label for="tab-y0xDLaV">features/todos/todosSlice.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-focused-lines"><code><span class="line has-focus"><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">sliceName</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;todos&#39;</span><span style="color:#ADBAC7;">;  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">getTodoList</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAsyncThunk</span><span style="color:#ADBAC7;">(</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">\`\${</span><span style="color:#ADBAC7;">sliceName</span><span style="color:#96D0FF;">}/getTodoList\`</span><span style="color:#ADBAC7;">, </span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">async</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">params</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#768390;">//...</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">postTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAsyncThunk</span><span style="color:#ADBAC7;">(</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">\`\${</span><span style="color:#ADBAC7;">sliceName</span><span style="color:#96D0FF;">}/postTodoItem\`</span><span style="color:#ADBAC7;">,  </span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">async</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">params</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#768390;">//...</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">// æ›´å¤šçš„ createAsyncThunk ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">todosSlice</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createSlice</span><span style="color:#ADBAC7;">({</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  name: sliceName,  </span></span>
<span class="line"><span style="color:#ADBAC7;">  initialState,</span></span>
<span class="line"><span style="color:#ADBAC7;">  reducers: { </span><span style="color:#768390;">//... },</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#DCBDFB;">extraReducers</span><span style="color:#ADBAC7;">: (</span><span style="color:#F69D50;">builder</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span><span style="color:#768390;">//... },</span></span>
<span class="line"><span style="color:#ADBAC7;">});</span></span>
<span class="line"></span></code></pre></div></div></div><h2 id="æå–-selector-function" tabindex="-1">æå– selector function <a class="header-anchor" href="#æå–-selector-function" aria-hidden="true">#</a></h2><p>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ <code>useSelector</code> hook ä» store è¯»å–æ•°æ®ï¼Œå®ƒä¼šæ¥å—ä¸€ä¸ªé€‰æ‹©å™¨å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ slice æ–‡ä»¶é‡Œæå‰å£°æ˜é€‰æ‹©å™¨å‡½æ•°ã€‚</p><p>æ¯”å¦‚ï¼šå°† <code>state =&gt; state.todos</code> é€‰æ‹©å™¨å‡½æ•°ä»ç»„ä»¶ä¸­æå–å‡ºæ¥ï¼Œå£°æ˜ä¸º <code>selectTodos</code> ï¼Œä½¿å¾—å®ƒå¯ä»¥åœ¨å…¶ä»–ç»„ä»¶ä¸­é‡å¤ä½¿ç”¨ï¼Œé¿å…äº†ä»£ç çš„é‡å¤ç¼–å†™ã€‚åŒæ—¶ä¹Ÿä½¿å¾—ç»„ä»¶çš„ä»£ç æ›´åŠ ç®€æ´æ¸…æ™°ã€‚</p><h3 id="before-1" tabindex="-1">before <a class="header-anchor" href="#before-1" aria-hidden="true">#</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-Yy43b" id="tab-doNovo1" checked="checked"><label for="tab-doNovo1">features/todos/Todos.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-highlighted-lines"><code><span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> { useAppSelector, useAppDispatch } </span><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;app/hooks&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">function</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">Todos</span><span style="color:#ADBAC7;">() {</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">todoList</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">useAppSelector</span><span style="color:#ADBAC7;">(</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> state.todos) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">return</span><span style="color:#ADBAC7;"> (</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#768390;">// omit rendering logic</span></span>
<span class="line"><span style="color:#ADBAC7;">   )</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span></code></pre></div></div></div><h3 id="after-1" tabindex="-1">after <a class="header-anchor" href="#after-1" aria-hidden="true">#</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-ZgDxW" id="tab-05jRjcL" checked="checked"><label for="tab-05jRjcL">features/todos/todosSlice.ts</label><input type="radio" name="group-ZgDxW" id="tab--jtewMs"><label for="tab--jtewMs">features/todos/Todos.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-focused-lines"><code><span class="line"><span style="color:#768390;">// omit createSlice</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">selectTodos</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">state</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">RootState</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> state.todos; </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">default</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">todoSlice</span><span style="color:#F69D50;">.</span><span style="color:#ADBAC7;">reducer;</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-focused-lines"><code><span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> { useAppSelector, useAppDispatch } </span><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;app/hooks&#39;</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> { selectTodos } </span><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;./todosSlice&#39;</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">function</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">Todos</span><span style="color:#ADBAC7;">() {</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">todoList</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">useAppSelector</span><span style="color:#ADBAC7;">(selectTodos) </span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">   </span><span style="color:#F47067;">return</span><span style="color:#ADBAC7;"> (</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#768390;">// omit rendering logic</span></span>
<span class="line"><span style="color:#ADBAC7;">   )</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span></code></pre></div></div></div><h2 id="å®šä¹‰-createasyncthunk-ç±»å‹" tabindex="-1">å®šä¹‰ createAsyncThunk ç±»å‹ <a class="header-anchor" href="#å®šä¹‰-createasyncthunk-ç±»å‹" aria-hidden="true">#</a></h2><p>å½“æˆ‘ä»¬ä½¿ç”¨ createAsyncThunk çš„ç¬¬äºŒä¸ªå‚æ•° payloadCreator å›è°ƒå‡½æ•°é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°æ—¶ï¼Œä½¿ç”¨ <code>thunkAPI.getState</code> è·å–æ•°æ®çš„æ—¶å€™ï¼ŒTS ç±»å‹æ£€æŸ¥ä¼šæŠ¥ ERRORï¼š<code>ç±»å‹â€œunknownâ€ä¸Šä¸å­˜åœ¨å±æ€§â€œtodosâ€</code></p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-b6O_y" id="tab-LPGarWm" checked="checked"><label for="tab-LPGarWm">features/todos/todosSlice.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-highlighted-lines"><code><span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">deleteTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAsyncThunk</span><span style="color:#ADBAC7;">(</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">\`\${</span><span style="color:#ADBAC7;">sliceName</span><span style="color:#96D0FF;">}/deleteTodoItem\`</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">async</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">_</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">thunkAPI</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line highlighted error"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">todos</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> thunkAPI.</span><span style="color:#DCBDFB;">getState</span><span style="color:#ADBAC7;">(); </span><span style="color:#768390;">// Property &#39;todos&#39; does not exist on type &#39;unknown&#39;.ts(2339)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">result</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">await</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">apiDeleteTodo</span><span style="color:#ADBAC7;">(todos.id);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">return</span><span style="color:#ADBAC7;"> result;</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span></code></pre></div></div></div><p>è®©æˆ‘ä»¬åœ¨ <code>createAsyncThunk.d.ts</code> çœ‹ä¸‹ thunkAPI ç±»å‹å®šä¹‰</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-PEDdL" id="tab-y6SHi-2" checked="checked"><label for="tab-y6SHi-2">node_modules/@reduxjs/toolkit/dist/createAsyncThunk.d.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-focused-lines"><code><span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">declare</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">type</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunkPayloadCreator</span><span style="color:#ADBAC7;">&lt;</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">Returned</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">ThunkArg</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">void</span><span style="color:#ADBAC7;">,</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">ThunkApiConfig</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">extends</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunkConfig</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> {}, </span></span>
<span class="line"><span style="color:#ADBAC7;">&gt; </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> (</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">arg</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">ThunkArg</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">thunkAPI</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">GetThunkAPI</span><span style="color:#ADBAC7;">&lt;</span><span style="color:#F69D50;">ThunkApiConfig</span><span style="color:#ADBAC7;">&gt;,</span></span>
<span class="line"><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunkPayloadCreatorReturnValue</span><span style="color:#ADBAC7;">&lt;</span><span style="color:#F69D50;">Returned</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">ThunkApiConfig</span><span style="color:#ADBAC7;">&gt;;</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F47067;">type</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunkConfig</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">/** return type for \`thunkApi.getState\` */</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">state</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">/** type for \`thunkApi.dispatch\` */</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">dispatch</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">Dispatch</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">/** type of the \`extra\` argument for the thunk middleware, which will be passed in as \`thunkApi.extra\` */</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">extra</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">/** type to be passed into \`rejectWithValue\`&#39;s first argument that will end up on \`rejectedAction.payload\` */</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">rejectValue</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">/** return type of the \`serializeError\` option callback */</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">serializedErrorType</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">/** type to be returned from the \`getPendingMeta\` option callback &amp; merged into \`pendingAction.meta\` */</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">pendingMeta</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">/** type to be passed into the second argument of \`fulfillWithValue\` to finally be merged into \`fulfilledAction.meta\` */</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">fulfilledMeta</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">/** type to be passed into the second argument of \`rejectWithValue\` to finally be merged into \`rejectedAction.meta\` */</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">rejectedMeta</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">};</span></span>
<span class="line"></span></code></pre></div></div></div><p>æˆ‘ä»¬å¯ä»¥çœ‹è§é™¤äº† <code>dispatch</code> å®šä¹‰äº†å…·ä½“ç±»å‹ <code>Dispatch</code>ï¼Œå…¶ä»–éƒ½æ˜¯ <code>unknown | undefined</code> ã€‚</p><p>æ‰€ä»¥å¦‚æœä½ æƒ³ä» payloadCreator ä¸­ä½¿ç”¨å®ƒä»¬ï¼Œéœ€è¦æ˜¾ç¤ºå®šä¹‰ thunkApi æ³›å‹å‚æ•°ï¼Œå› ä¸ºè¿™äº›å‚æ•°çš„ç±»å‹æ— æ³•æ¨æ–­å‡ºæ¥ã€‚</p><p>æ­¤å¤–ï¼Œ<strong>ç”±äº TS æ— æ³•æ··åˆæ˜¾å¼å’Œæ¨æ–­æ³›å‹å‚æ•°</strong>ï¼Œè¿˜éœ€è¦å®šä¹‰ payloadCreator çš„ Return type å’Œ First argument æ³›å‹å‚æ•°ã€‚</p><p>æ¯”å¦‚ï¼šä½ å¯ä»¥ä¼ å…¥æ³›å‹å‚æ•° <code>&lt;boolean, void, { state: RootState }&gt; </code></p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-S-aV2" id="tab-gTPzA4G" checked="checked"><label for="tab-gTPzA4G">features/todos/todosSlice.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-focused-lines"><code><span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">deleteTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> createAsyncThunk</span><span style="color:#F47067;">&lt;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  boolean, </span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">void</span><span style="color:#ADBAC7;">,</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">  { </span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">: RootState }</span></span>
<span class="line"><span style="color:#F47067;">&gt;</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">\`\${</span><span style="color:#ADBAC7;">sliceName</span><span style="color:#96D0FF;">}/deleteTodoItem\`</span><span style="color:#ADBAC7;">, </span><span style="color:#F47067;">async</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">_</span><span style="color:#ADBAC7;">, { </span><span style="color:#F69D50;">getState</span><span style="color:#ADBAC7;"> }) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">todos</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">getState</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">result</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">await</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">apiDeleteTodo</span><span style="color:#ADBAC7;">(todos.id);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">return</span><span style="color:#ADBAC7;"> result;</span></span>
<span class="line"><span style="color:#ADBAC7;">});</span></span>
<span class="line"></span></code></pre></div></div></div><p>å¦‚æœä½ è§‰å¾—è¿™æ ·å†™å¾ˆéº»çƒ¦ï¼Œ<strong>å› ä¸º TypeScript å¯ä»¥æ¨æ–­å‡º Return type å’Œ First argument ç±»å‹</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ˜¾å¼å®šä¹‰ thunkApi.getState æ–¹æ³•çš„ç±»å‹å³å¯ï¼Œ<strong>æ— éœ€å†æ˜¾å¼å®šä¹‰è¿™ä¸¤ä¸ªç±»å‹</strong>ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Type Assertions ä¸­çš„ <code>as</code> å…³é”®å­—ï¼Œä»è€Œé¿å…äº†é‡å¤å®šä¹‰ç±»å‹ã€‚</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-9YvJL" id="tab-pcFyEmE" checked="checked"><label for="tab-pcFyEmE">features/todos/todosSlice.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-focused-lines"><code><span class="line has-focus"><span style="color:#768390;">// or </span></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">deleteTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAsyncThunk</span><span style="color:#ADBAC7;">(</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">\`\${</span><span style="color:#ADBAC7;">sliceName</span><span style="color:#96D0FF;">}/deleteTodoItem\`</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">async</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">_</span><span style="color:#ADBAC7;">, { </span><span style="color:#F69D50;">getState</span><span style="color:#ADBAC7;"> }) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">todos</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">getState</span><span style="color:#ADBAC7;">() </span><span style="color:#F47067;">as</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">RootState</span><span style="color:#ADBAC7;">; </span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">result</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">await</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">apiDeleteTodo</span><span style="color:#ADBAC7;">(todos.id);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">return</span><span style="color:#ADBAC7;"> result;</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span></code></pre></div></div></div><p>å¦‚æœä½ è§‰å¾—è¿™æ ·å°±è§£å†³äº†é—®é¢˜ï¼Œé‚£ä¹ˆå½“ä½ æ¯æ¬¡è°ƒç”¨å¤§é‡çš„ createAsyncThunk æ—¶ï¼Œä¼šå‘ç°æ¯æ¬¡æ˜¾å¼å£°æ˜ç±»å‹éƒ½å¾ˆéº»çƒ¦ï¼Œè¿™åº”è¯¥ç”± TypeScript ç±»å‹æ¨æ–­æ¥å®Œæˆã€‚</p><p>ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½çš„<strong>é¿å…å¼ºåˆ¶è½¬æ¢ç±»å‹</strong>ï¼Œå› ä¸ºè¿™æ­£æ˜¯ TypeScript çš„ä½¿ç”¨æ„ä¹‰ä¹‹ä¸€ï¼Œè®©è¯­è¨€è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿé¿å…äº†å¾ªç¯ä¾èµ–çš„é—®é¢˜ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ TypeScript çš„<a href="https://www.typescriptlang.org/docs/handbook/declaration-merging.html#module-augmentation" target="_blank" rel="noreferrer">æ¨¡ç»„æ‰©å……</a>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é€šè¿‡ä½¿ç”¨æ¨¡å—å¢å¼ºåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥å°†é»˜è®¤çŠ¶æ€åˆ†é…ç»™ AsyncThunkConfig.stateï¼Œè¿™æ ·åœ¨ç¨åè°ƒç”¨ <code>getState()</code> æ—¶å°±èƒ½è¿”å›æ­£ç¡®çš„ç±»å‹ã€‚</p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-Tinvc" id="tab-W7mK87B" checked="checked"><label for="tab-W7mK87B">app/store.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed"><code><span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> { AsyncThunk, AsyncThunkOptions, AsyncThunkPayloadCreator, Dispatch } </span><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;@reduxjs/toolkit&#39;</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#768390;">// omit configureStore</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">declare</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">module</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&quot;@reduxjs/toolkit&quot;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">type</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunkConfig</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">state</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">dispatch</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">Dispatch</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">extra</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">rejectValue</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">serializedErrorType</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">unknown</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"><span style="color:#ADBAC7;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">function</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAsyncThunk</span><span style="color:#ADBAC7;">&lt;</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">Returned</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">ThunkArg</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">void</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">ThunkApiConfig</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">extends</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunkConfig</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> { </span><span style="color:#F69D50;">state</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">RootState</span><span style="color:#ADBAC7;"> } </span><span style="color:#768390;">// here is the magic line</span></span>
<span class="line"><span style="color:#ADBAC7;">    &gt;(</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">typePrefix</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">string</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">payloadCreator</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunkPayloadCreator</span><span style="color:#ADBAC7;">&lt;</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">Returned</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">ThunkArg</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">            </span><span style="color:#F69D50;">ThunkApiConfig</span></span>
<span class="line"><span style="color:#ADBAC7;">        &gt;,</span></span>
<span class="line"><span style="color:#ADBAC7;">        </span><span style="color:#F69D50;">options</span><span style="color:#F47067;">?:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunkOptions</span><span style="color:#ADBAC7;">&lt;</span><span style="color:#F69D50;">ThunkArg</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">ThunkApiConfig</span><span style="color:#ADBAC7;">&gt;,</span></span>
<span class="line"><span style="color:#ADBAC7;">    )</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AsyncThunk</span><span style="color:#ADBAC7;">&lt;</span><span style="color:#F69D50;">Returned</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">ThunkArg</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">ThunkApiConfig</span><span style="color:#ADBAC7;">&gt;;</span></span>
<span class="line"><span style="color:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#F69D50;"> </span><span style="color:#F47067;">default</span><span style="color:#F69D50;"> </span><span style="color:#ADBAC7;">store;</span></span>
<span class="line"></span></code></pre></div></div></div><p>è¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨ <code>createAsyncThunk</code> å»æ˜¾å¼å£°æ˜ç±»å‹ã€‚</p><p>è¿™æ˜¯ RTK 1.9 ä¹‹å‰çš„è§£å†³åŠæ³•ï¼ŒRedux å®˜æ–¹ä¹Ÿæ³¨æ„åˆ°è¿™ä¸€ç‚¹ï¼Œäºæ˜¯æä¾›äº† <code>createAsyncThunk.withTypes&lt;&gt;()</code></p><h2 id="å®šä¹‰é¢„ç±»å‹-createasyncthunk" tabindex="-1">å®šä¹‰é¢„ç±»å‹ <code>createAsyncThunk</code> <a class="header-anchor" href="#å®šä¹‰é¢„ç±»å‹-createasyncthunk" aria-hidden="true">#</a></h2><p>ä»RTK 1.9å¼€å§‹ï¼Œä½ å¯ä»¥è°ƒç”¨ <code>createAsyncThunk.withTypes&lt;&gt;()</code> å¹¶ä¼ å…¥ä¸€ä¸ªåŒ…å« AsyncThunkConfig ä¸­ä»»ä½•å­—æ®µçš„å­—æ®µåå’Œç±»å‹çš„å¯¹è±¡ã€‚</p><p>è¿™è®©ä½ å¯ä»¥<strong>ä¸€æ¬¡è®¾ç½®è¿™äº›ç±»å‹</strong>ï¼Œä»è€Œæ— éœ€åœ¨æ¯æ¬¡è°ƒç”¨ createAsyncThunk æ—¶<strong>é‡å¤å®šä¹‰</strong>å®ƒä»¬ã€‚</p><p><strong>usage:</strong></p><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-NrWfU" id="tab-BbfWNWV" checked="checked"><label for="tab-BbfWNWV">app/store.util.ts</label><input type="radio" name="group-NrWfU" id="tab-P-ocCg8"><label for="tab-P-ocCg8">features/todos/todosSlice.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed"><code><span class="line"><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">createAppAsyncThunk</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> createAsyncThunk.</span><span style="color:#DCBDFB;">withTypes</span><span style="color:#ADBAC7;">&lt;{</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">state</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">RootState</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">dispatch</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AppDispatch</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#768390;">// other fields type</span></span>
<span class="line"><span style="color:#ADBAC7;">}&gt;();</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed"><code><span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">deleteTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAsyncThunk</span><span style="color:#ADBAC7;">(</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">\`\${</span><span style="color:#ADBAC7;">sliceName</span><span style="color:#96D0FF;">}/deleteTodoItem\`</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">async</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">_</span><span style="color:#ADBAC7;">, { </span><span style="color:#F69D50;">getState</span><span style="color:#ADBAC7;"> }) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">todos</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">getState</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">result</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">await</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">apiDeleteTodo</span><span style="color:#ADBAC7;">(todos.id);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">return</span><span style="color:#ADBAC7;"> result;</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span></code></pre></div></div></div><p>è¿™æ ·ä»£ç çœ‹èµ·æ¥å°±ç®€æ´å¤šäº† ğŸ˜</p><h2 id="ä½¿ç”¨-addmatcher-å¤„ç†é‡å¤çŠ¶æ€ä¿®æ”¹" tabindex="-1">ä½¿ç”¨ addMatcher å¤„ç†é‡å¤çŠ¶æ€ä¿®æ”¹ <a class="header-anchor" href="#ä½¿ç”¨-addmatcher-å¤„ç†é‡å¤çŠ¶æ€ä¿®æ”¹" aria-hidden="true">#</a></h2><p>ç®€å•å›é¡¾ä¸‹ç”¨æ³•ï¼š</p><p><code>builder.addCase</code>: å¤„ç†<strong>å•ä¸ªç²¾ç¡®</strong>çš„ action typeã€‚</p><p><code>builder.addMatcher</code>: æ ¹æ®ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆåŒ¹é…å™¨å‡½æ•°ï¼‰ï¼Œå¤„ç†<strong>å‡½æ•°åŒ¹é…</strong>çš„ action typeã€‚</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>æ‰€æœ‰ builder.addMatcher çš„è°ƒç”¨éƒ½å¿…é¡»æ”¾åœ¨ä»»ä½• builder.addCase ä¹‹åè°ƒç”¨</p></div><p>æ¥ä¸‹æ¥ï¼Œä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><p>å½“æˆ‘ä»¬åœ¨è·å– TodoList å‘èµ·å¼‚æ­¥è¯·æ±‚æ—¶</p><p><code>&#39;todos/getTodoList&#39;</code> å°†ç”Ÿæˆè¿™äº› action types:</p><ul><li>pending: <code>&#39;todos/getTodoList/pending&#39;</code></li><li>fulfilled: <code>&#39;todos/getTodoList/fulfilled&#39;</code></li><li>rejected: <code>&#39;todos/getTodoList/rejected&#39;</code></li></ul><p>æˆ‘ä»¬éœ€è¦åœ¨ pending é˜¶æ®µå°† <code>loading</code> çŠ¶æ€æ”¹æˆ <code>true</code>ï¼Œfulfilled å’Œ rejected å°† <code>loading</code> çŠ¶æ€æ”¹æˆ <code>false</code>ã€‚</p><h3 id="ä½¿ç”¨-addcase" tabindex="-1">ä½¿ç”¨ addCase <a class="header-anchor" href="#ä½¿ç”¨-addcase" aria-hidden="true">#</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-oEhKE" id="tab-ucv3dd8" checked="checked"><label for="tab-ucv3dd8">features/todos/todosSlice.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-highlighted-lines"><code><span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">getTodoList</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAppAsyncThunk</span><span style="color:#ADBAC7;">(</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#96D0FF;">\`\${</span><span style="color:#ADBAC7;">sliceName</span><span style="color:#96D0FF;">}/getTodoList\`</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F47067;">async</span><span style="color:#ADBAC7;"> () </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> { </span><span style="color:#6CB6FF;">result</span><span style="color:#ADBAC7;"> } </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">await</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">apiGetTodoList</span><span style="color:#ADBAC7;">();</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">return</span><span style="color:#ADBAC7;"> result;</span></span>
<span class="line"><span style="color:#ADBAC7;">  }</span></span>
<span class="line"><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">postTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAppAsyncThunk</span><span style="color:#ADBAC7;">(</span><span style="color:#768390;">/* omit logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">putTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAppAsyncThunk</span><span style="color:#ADBAC7;">(</span><span style="color:#768390;">/* omit logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">deleteTodoItem</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createAppAsyncThunk</span><span style="color:#ADBAC7;">(</span><span style="color:#768390;">/* omit logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">todosSlice</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createSlice</span><span style="color:#ADBAC7;">({</span></span>
<span class="line"><span style="color:#ADBAC7;">  name: sliceName,</span></span>
<span class="line"><span style="color:#ADBAC7;">  initialState,</span></span>
<span class="line"><span style="color:#ADBAC7;">  reducers: {</span><span style="color:#768390;">/* omit */</span><span style="color:#ADBAC7;">},</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#DCBDFB;">extraReducers</span><span style="color:#ADBAC7;">: (</span><span style="color:#F69D50;">builder</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    builder</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(getTodoList.pending, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#ADBAC7;">; </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      })</span></span>
<span class="line"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(getTodoList.fulfilled, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">action</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> (</span><span style="color:#768390;">/* omit success logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(getTodoList.rejected, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#ADBAC7;">;</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      })</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(postTodoItem.pending, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#ADBAC7;">;</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      })</span></span>
<span class="line"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(postTodoItem.fulfilled, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">action</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> (</span><span style="color:#768390;">/* omit success logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(postTodoItem.rejected, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#ADBAC7;">;</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      })</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(putTodoItem.pending, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#ADBAC7;">;</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      })</span></span>
<span class="line"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(putTodoItem.fulfilled, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">action</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> (</span><span style="color:#768390;">/* omit success logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(putTodoItem.rejected, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#ADBAC7;">;</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      })</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(deleteTodoItem.pending, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#ADBAC7;">;</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      })</span></span>
<span class="line"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(deleteTodoItem.fulfilled, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">action</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> (</span><span style="color:#768390;">/* omit success logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(deleteTodoItem.rejected, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#ADBAC7;">;</span></span>
<span class="line highlighted"><span style="color:#ADBAC7;">      })</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">});</span></span>
<span class="line"></span></code></pre></div></div></div><p>å¯ä»¥ä»ä»£ç é«˜äº®çœ‹è§ï¼Œæˆ‘ä»¬åœ¨æ‰€æœ‰ action type çš„ pending, fulfilled å’Œ rejected é˜¶æ®µï¼Œéƒ½å¯¹ <code>state.loading</code> è¿›è¡Œäº†çŠ¶æ€ä¿®æ”¹ï¼Œå¯¼è‡´å­˜åœ¨å¤§é‡é‡å¤çŠ¶æ€ä¿®æ”¹ä»£ç ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>addMatcher</code> æ¥åŒ¹é…ç›¸åŒçš„é˜¶æ®µï¼Œå¹¶åˆ›å»º <code>isPendingAction</code>, <code>isFulfilledAction</code>, <code>isRejectedAction</code> ä¸‰ä¸ª matcher function æ¥å¤„ç†ã€‚</p><h3 id="ä½¿ç”¨-addmatcher" tabindex="-1">ä½¿ç”¨ addMatcher <a class="header-anchor" href="#ä½¿ç”¨-addmatcher" aria-hidden="true">#</a></h3><div class="vp-code-group"><div class="tabs"><input type="radio" name="group-0tDW6" id="tab-J67KuLs" checked="checked"><label for="tab-J67KuLs">features/todos/todosSlice.ts</label><input type="radio" name="group-0tDW6" id="tab-AVnrnqM"><label for="tab-AVnrnqM">app/store.util.ts</label></div><div class="blocks"><div class="language-ts active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed has-focused-lines"><code><span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> { createSlice, createAsyncThunk } </span><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;@reduxjs/toolkit&#39;</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> { isPendingAction, isFulfilledAction, isRejectedAction } </span><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;app/store.util&#39;</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">todosSlice</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">createSlice</span><span style="color:#ADBAC7;">({</span></span>
<span class="line"><span style="color:#ADBAC7;">  name: sliceName,</span></span>
<span class="line"><span style="color:#ADBAC7;">  initialState,</span></span>
<span class="line"><span style="color:#ADBAC7;">  reducers: {</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#768390;">// omit</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#DCBDFB;">extraReducers</span><span style="color:#ADBAC7;">: (</span><span style="color:#F69D50;">builder</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line"><span style="color:#ADBAC7;">    builder</span></span>
<span class="line"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(getTodoList.fulfilled, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">action</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> (</span><span style="color:#768390;">/* omit success logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(postTodoItem.fulfilled, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">action</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> (</span><span style="color:#768390;">/* omit success logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(putTodoItem.fulfilled, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">action</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> (</span><span style="color:#768390;">/* omit success logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addCase</span><span style="color:#ADBAC7;">(deleteTodoItem.fulfilled, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">action</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> (</span><span style="color:#768390;">/* omit success logic */</span><span style="color:#ADBAC7;">);</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addMatcher</span><span style="color:#ADBAC7;">(isPendingAction, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> { </span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">true</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">      })</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">      .</span><span style="color:#DCBDFB;">addMatcher</span><span style="color:#ADBAC7;">(isFulfilledAction </span><span style="color:#F47067;">||</span><span style="color:#ADBAC7;"> isRejectedAction, (</span><span style="color:#F69D50;">state</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> {</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">        state.loading </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">false</span><span style="color:#ADBAC7;">;</span></span>
<span class="line has-focus"><span style="color:#ADBAC7;">      });</span></span>
<span class="line"><span style="color:#ADBAC7;">  },</span></span>
<span class="line"><span style="color:#ADBAC7;">});</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-dark-dimmed"><code><span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> { AnyAction } </span><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;@reduxjs/toolkit&#39;</span><span style="color:#ADBAC7;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">isPendingAction</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">action</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AnyAction</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> action.type.</span><span style="color:#DCBDFB;">endsWith</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&#39;/pending&#39;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">isFulfilledAction</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">action</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AnyAction</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> action.type.</span><span style="color:#DCBDFB;">endsWith</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&#39;/fulfilled&#39;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"><span style="color:#F47067;">export</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">const</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">isRejectedAction</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> (</span><span style="color:#F69D50;">action</span><span style="color:#F47067;">:</span><span style="color:#ADBAC7;"> </span><span style="color:#F69D50;">AnyAction</span><span style="color:#ADBAC7;">) </span><span style="color:#F47067;">=&gt;</span><span style="color:#ADBAC7;"> action.type.</span><span style="color:#DCBDFB;">endsWith</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&#39;/rejected&#39;</span><span style="color:#ADBAC7;">);</span></span>
<span class="line"></span></code></pre></div></div></div><p>è¿™æ ·ä»£ç æ˜¯ä¸æ˜¯å°±æ¸…æ™°å¤šäº† ğŸ˜</p><h2 id="æœ€å" tabindex="-1">æœ€å <a class="header-anchor" href="#æœ€å" aria-hidden="true">#</a></h2><p>å¸Œæœ›å¯¹ä½ ä½¿ç”¨ RTK æœ‰æ‰€å¸®åŠ©ï¼Œå¦‚æœæœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œä¹Ÿæ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºåˆ†äº«è‡ªå·±å¯¹ RTK çš„ä½¿ç”¨ç»éªŒã€‚</p><h2 id="å‚è€ƒ" tabindex="-1">å‚è€ƒ <a class="header-anchor" href="#å‚è€ƒ" aria-hidden="true">#</a></h2><blockquote><p><a href="https://redux-toolkit.js.org/" target="_blank" rel="noreferrer">https://redux-toolkit.js.org/</a></p><p><a href="https://github.com/Tencent/tdesign-react-starter" target="_blank" rel="noreferrer">https://github.com/Tencent/tdesign-react-starter</a></p><p><a href="https://stackoverflow.com/questions/64793504/cannot-set-getstate-type-to-rootstate-in-createasyncthunk" target="_blank" rel="noreferrer">https://stackoverflow.com/questions/64793504/cannot-set-getstate-type-to-rootstate-in-createasyncthunk</a></p><p><a href="https://github.com/reduxjs/redux-toolkit/issues/486" target="_blank" rel="noreferrer">https://github.com/reduxjs/redux-toolkit/issues/486</a></p></blockquote>`,68),e=[o];function t(c,r,A,y,i,D){return a(),n("div",null,e)}const B=s(p,[["render",t]]);export{C as __pageData,B as default};
